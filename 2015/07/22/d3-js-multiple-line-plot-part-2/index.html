<!doctype html>
<!--[if !IE]>
<html class="no-js non-ie" lang="en-US"> <![endif]-->
<!--[if IE 7 ]>
<html class="no-js ie7" lang="en-US"> <![endif]-->
<!--[if IE 8 ]>
<html class="no-js ie8" lang="en-US"> <![endif]-->
<!--[if IE 9 ]>
<html class="no-js ie9" lang="en-US"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en-US"> <!--<![endif]-->
<head>
<base href="https://lpplmarketwatch.com" />

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="">
<link rel="profile" href="http://gmpg.org/xfn/11">

<title>D3.js Multiple Line Plot &#8211; Part 2 &#8211; LPPL Market Watch</title>
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="LPPL Market Watch &raquo; Feed" href="https://lpplmarketwatch.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="LPPL Market Watch &raquo; Comments Feed" href="https://lpplmarketwatch.com/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="LPPL Market Watch &raquo; D3.js Multiple Line Plot &#8211; Part 2 Comments Feed" href="https://lpplmarketwatch.com/2015/07/22/d3-js-multiple-line-plot-part-2/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/lpplmarketwatch.com\/wp-includes\/js\/wp-emoji-release.min.js"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56794,8205,9794,65039],[55358,56794,8203,9794,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='sparkling-bootstrap-css'  href='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/css/bootstrap.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-icons-css'  href='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/css/font-awesome.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-fonts-css'  href='//fonts.googleapis.com/css?family=Open+Sans%3A400italic%2C400%2C600%2C700%7CRoboto+Slab%3A400%2C300%2C700&#038;ver=4.9.2' type='text/css' media='all' />
<link rel='stylesheet' id='sparkling-style-css'  href='https://lpplmarketwatch.com/wp-content/themes/sparkling/style.css' type='text/css' media='all' />
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/js/vendor/modernizr.min.js'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/js/vendor/bootstrap.min.js'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/js/functions.min.js'></script>
<link rel='https://api.w.org/' href='https://lpplmarketwatch.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://lpplmarketwatch.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://lpplmarketwatch.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='D3.js Multiple Line Plot &#8211; Part 1' href='https://lpplmarketwatch.com/2015/07/21/d3-multiple-line-plot-part-1/' />
<link rel='next' title='D3.js Multiple Line Plot &#8211; Part 3' href='https://lpplmarketwatch.com/2015/07/24/d3-js-multiple-line-plot-part-3/' />
<meta name="generator" content="WordPress 4.9.2" />
<link rel="canonical" href="https://lpplmarketwatch.com/2015/07/22/d3-js-multiple-line-plot-part-2/" />
<link rel='shortlink' href='https://lpplmarketwatch.com/?p=640' />
<link rel="alternate" type="application/json+oembed" href="https://lpplmarketwatch.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flpplmarketwatch.com%2F2015%2F07%2F22%2Fd3-js-multiple-line-plot-part-2%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://lpplmarketwatch.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Flpplmarketwatch.com%2F2015%2F07%2F22%2Fd3-js-multiple-line-plot-part-2%2F&#038;format=xml" />
<style type="text/css"></style><link rel="pingback" href="https://lpplmarketwatch.com/xmlrpc.php">
</head>

<body class="post-template-default single single-post postid-640 single-format-standard">
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>
<div id="page" class="hfeed site">

	<header id="masthead" class="site-header" role="banner">
		<nav class="navbar navbar-default " role="navigation">
			<div class="container">
				<div class="row">
					<div class="site-navigation-inner col-sm-12">
						<div class="navbar-header">
							<button type="button" class="btn navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>

														<div id="logo">
															<p class="site-name">																		<a class="navbar-brand" href="https://lpplmarketwatch.com/" title="LPPL Market Watch" rel="home">LPPL Market Watch</a>
																</p>																													</div><!-- end of #logo -->
						</div>
											</div>
				</div>
			</div>
		</nav><!-- .site-navigation -->
	</header><!-- #masthead -->

	<div id="content" class="site-content">

		<div class="top-section">
								</div>

		<div class="container main-content-area">
						<div class="row side-pull-left">
				<div class="main-content-inner col-sm-12 col-md-8">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		<article id="post-640" class="post-640 post type-post status-publish format-standard hentry category-code category-d3 category-programming category-website">
		<div class="post-inner-content">
		<header class="entry-header page-header">

			<h1 class="entry-title ">D3.js Multiple Line Plot &#8211; Part 2</h1>

			<div class="entry-meta">
				<span class="posted-on"><i class="fa fa-calendar"></i> <a href="https://lpplmarketwatch.com/2015/07/22/d3-js-multiple-line-plot-part-2/" rel="bookmark"><time class="entry-date published" datetime="2015-07-22T01:01:29+00:00">July 22, 2015</time></a></span><span class="byline"> <i class="fa fa-user"></i> <span class="author vcard"><a class="url fn n" href="https://lpplmarketwatch.com/author/lpplmarketwatch/">lpplmarketwatch</a></span></span>
								<span class="cat-links"><i class="fa fa-folder-open-o"></i>
				 <a href="https://lpplmarketwatch.com/category/code/" rel="category tag">code</a>, <a href="https://lpplmarketwatch.com/category/d3/" rel="category tag">d3</a>, <a href="https://lpplmarketwatch.com/category/programming/" rel="category tag">programming</a>, <a href="https://lpplmarketwatch.com/category/website/" rel="category tag">website</a>				</span>
								
			</div><!-- .entry-meta -->
		</header><!-- .entry-header -->

		<div class="entry-content">
			<p>Working version of the plot, download <a href="https://cdn.thebubbleindex.com/Docs/plot_working_07272015.zip">here</a>.</p>
<p>As mentioned before, the following code is presented &#8220;as it is&#8221; in its current version. Some functions and variables are presented out of order.</p>
<p>The SVG variable is created by a D3 selection. The &#8220;plotarea&#8221; &lt;div&gt; is selected as the element where the SVG plot will be created. A &#8220;g&#8221; element is appended to the plot. This will allow the time-series to be grouped together as a single object.</p>
<pre><code>var svg = d3.select("#plotarea").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
    .attr("id", "svgMain");
</code></pre>
<p>The source data is of course the most important piece in the puzzle. In order to create an SVG plot containing multiple lines which each share the same set of dates, make sure that the data is formatted and aligned correctly. For instance, create a tab-separated file which contains a header entry for each column. And make sure each row contains an entry for each column. Thus, if no data is available for a specific date and column, place a value of 0, ensuring no gaps in the data. However, depending on the structure of the data, this may not work for all applications.</p>
<p>An example header for the tsv file: &#8220;date 52 Days 104 Days 153 Days 256 Days 512 Days&#8221;, where each &#8220;# Days&#8221; entry is separated by a tab.</p>
<p>Example:</p>
<pre><code>date    52 Days    104 Days
2015-05-01    52.0    102.0
2015-05-02    54.0    104.0
</code></pre>
<p>D3 has a function called &#8220;d3.tsv&#8221; which easily requests and loads a tab-separated file into the browser memory.</p>
<p>Once this raw data has been loaded, the &#8220;d3.tsv&#8221; function enters a callback. This is where the data is parsed, turned into SVG objects, and loaded into a DOM element.</p>
<p>Since there are multiple time-series, there will be a separate map for each column. The &#8220;indices&#8221; variable contains the separate time-series as a key-value pair mapping in memory. Each column header (i.e. 52 Days) is the key for a time-series. The value entry of the &#8220;indices&#8221; map is itself another map object. This additional map object will have a set of key-value pairs between dates and numerical values. Thus, if there are 5 column headers (excluding the date column) then the &#8220;indices&#8221; object will have 5 keys. And, if there are 252 date rows, each map associated with each one of the 5 keys will have 252 date keys.</p>
<p>Once the data is stored as a map, the D3 &#8220;domain&#8221; functions &#8212; in combination with the D3 max and min functions &#8212; will determine the numerical and time-line ranges of ALL the time-series data.</p>
<pre><code>d3.tsv("data-location_name.tsv", function(error, data) {
    color.domain(d3.keys(data[0]).filter(function(key) {
        return key !== "date";
    }));

    data.forEach(function(d) {
        d.date = parseDate(d.date);
    });

    indices = color.domain().map(function(name) {
        return {
            name: name.substring(0, name.indexOf(" Days")),
            values: data.map(function(d) {
                return {
                    date: d.date,
                    yvalue: +d[name]
                };
            })
        };
    });
    origData = data;
    x.domain(d3.extent(data, function(d) {
        return d.date;
    }));

    y.domain([
        d3.min(indices, function(c) {
            return d3.min(c.values, function(v) {
                return v.yvalue;
            });
        }),
        d3.max(indices, function(c) {
            return d3.max(c.values, function(v) {
                return v.yvalue;
            });
        })
    ]);
</code></pre>
					</div><!-- .entry-content -->

		<footer class="entry-meta">

			
		</footer><!-- .entry-meta -->
	</div>

	
</article><!-- #post-## -->

<div id="comments" class="comments-area">

		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2015/07/22/d3-js-multiple-line-plot-part-2/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="https://lpplmarketwatch.com/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
				<p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required='true' required='required' /></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required='true' required='required' /></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" /></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='640' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p>			</form>
			</div><!-- #respond -->
	
</div><!-- #comments -->

	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://lpplmarketwatch.com/2015/07/21/d3-multiple-line-plot-part-1/" rel="prev"><i class="fa fa-chevron-left"></i> <span class="post-title">D3.js Multiple Line Plot &#8211; Part 1</span></a></div><div class="nav-next"><a href="https://lpplmarketwatch.com/2015/07/24/d3-js-multiple-line-plot-part-3/" rel="next"><span class="post-title">D3.js Multiple Line Plot &#8211; Part 3 <i class="fa fa-chevron-right"></i></span></a></div></div>
	</nav>
		</main><!-- #main -->
	</div><!-- #primary -->

</div><!-- close .main-content-inner -->
<div id="secondary" class="widget-area col-sm-12 col-md-4" role="complementary">
	<div class="well">
						<aside id="recent-posts-2" class="widget widget_recent_entries">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="https://lpplmarketwatch.com/2018/02/03/mean-value-vs-window-plot/">Mean Value vs. Window &#8211; Plot</a>
									</li>
											<li>
					<a href="https://lpplmarketwatch.com/2015/07/31/three-js-3d-contour-plot-part-1/">Three.js 3D Contour Plot &#8211; Part 1</a>
									</li>
											<li>
					<a href="https://lpplmarketwatch.com/2015/07/30/d3-js-multiple-line-plot-part-6/">D3.js Multiple Line Plot &#8211; Part 6</a>
									</li>
											<li>
					<a href="https://lpplmarketwatch.com/2015/07/29/d3-js-multiple-line-plot-part-5/">D3.js Multiple Line Plot &#8211; Part 5</a>
									</li>
											<li>
					<a href="https://lpplmarketwatch.com/2015/07/28/d3-js-multiple-line-plot-part-4/">D3.js Multiple Line Plot &#8211; Part 4</a>
									</li>
					</ul>
		</aside><aside id="archives-2" class="widget widget_archive"><h3 class="widget-title">Archives</h3>		<ul>
			<li><a href='https://lpplmarketwatch.com/2018/02/'>February 2018</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/07/'>July 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/05/'>May 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/04/'>April 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/03/'>March 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/02/'>February 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2015/01/'>January 2015</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/12/'>December 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/11/'>November 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/10/'>October 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/09/'>September 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/08/'>August 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/07/'>July 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/06/'>June 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/05/'>May 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/04/'>April 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/03/'>March 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/02/'>February 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2014/01/'>January 2014</a></li>
	<li><a href='https://lpplmarketwatch.com/2013/11/'>November 2013</a></li>
	<li><a href='https://lpplmarketwatch.com/2013/08/'>August 2013</a></li>
	<li><a href='https://lpplmarketwatch.com/2013/06/'>June 2013</a></li>
	<li><a href='https://lpplmarketwatch.com/2013/05/'>May 2013</a></li>
		</ul>
		</aside>	</div>
</div><!-- #secondary -->
		</div><!-- close .row -->
	</div><!-- close .container -->
</div><!-- close .site-content -->

	<div id="footer-area">
		<div class="container footer-inner">
			<div class="row">
				
				</div>
		</div>

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info container">
				<div class="row">
										<nav role="navigation" class="col-md-6">
											</nav>
					<div class="copyright col-md-6">
						sparkling						Theme by <a href="http://colorlib.com/" target="_blank">Colorlib</a> Powered by <a href="http://wordpress.org/" target="_blank">WordPress</a>					</div>
				</div>
			</div><!-- .site-info -->
			<div class="scroll-to-top"><i class="fa fa-angle-up"></i></div><!-- .scroll-to-top -->
		</footer><!-- #colophon -->
	</div>
</div><!-- #page -->

		  <script type="text/javascript">
			jQuery( document ).ready( function( $ ){
			  if ( $( window ).width() >= 767 ){
				$( '.navbar-nav > li.menu-item > a' ).click( function(){
					if( $( this ).attr('target') !== '_blank' ){
						window.location = $( this ).attr( 'href' );
					}
				});
			  }
			});
		  </script>
		<script type='text/javascript' src='https://lpplmarketwatch.com/wp-content/themes/sparkling/assets/js/skip-link-focus-fix.min.js?ver=20140222'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-includes/js/comment-reply.min.js'></script>
<script type='text/javascript' src='https://lpplmarketwatch.com/wp-includes/js/wp-embed.min.js'></script>

</body>
</html>
